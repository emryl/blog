<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>How to Migrate From an Existing UBNT EdgeRouter to a USG | Lots of emryl</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="ubnt,unifi" />
    
    <meta name="description" content="So you’ve been secretly oogling the shiny USG device and the been frustrated with the Controller software and blank graphics like me? I can verify that the migration process is quite straight forward,">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Migrate From an Existing UBNT EdgeRouter to a USG">
<meta property="og:url" content="https://blog.rylander.io/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/index.html">
<meta property="og:site_name" content="Lots of emryl">
<meta property="og:description" content="So you’ve been secretly oogling the shiny USG device and the been frustrated with the Controller software and blank graphics like me? I can verify that the migration process is quite straight forward,">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.rylander.io/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/89b8de5c-2eed-4682-bfce-5fd8fab45e14.jpg">
<meta property="article:published_time" content="2017-06-29T19:12:47.000Z">
<meta property="article:modified_time" content="2017-06-29T19:12:47.000Z">
<meta property="article:author" content="emryl">
<meta property="article:tag" content="ubnt">
<meta property="article:tag" content="unifi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.rylander.io/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/89b8de5c-2eed-4682-bfce-5fd8fab45e14.jpg">
    

    

    
        <link rel="icon" href="/images/favicon.ico" />
    

    <script type="text/javascript">
        window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(){}function o(e,t,n){return function(){return i(e,[f.now()].concat(u(arguments)),t?null:this,n),t?void 0:this}}var i=e("handle"),a=e(2),u=e(3),c=e("ee").get("tracer"),f=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,t){s[t]=o(d+t,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,o="function"==typeof t;return i(l+"tracer",[f.now(),e,n],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],n),o)try{return t.apply(this,arguments)}catch(e){throw c.emit("fn-err",[arguments,this,e],n),e}finally{c.emit("fn-end",[f.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=o(l+t)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,f.now()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(o<0?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],4:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?c(e,u,i):i()}function n(n,r,o,i){if(!d.aborted||i){e&&e(n,r,o);for(var a=t(o),u=m(n),c=u.length,f=0;f<c;f++)u[f].apply(a,r);var p=s[y[n]];return p&&p.push([b,n,r,a]),a}}function l(e,t){v[e]=m(e).concat(t)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(n)}function g(e,t){f(e,function(e,n){t=t||"feature",y[n]=t,t in s||(s[t]=[])})}var v={},y={},b={on:l,emit:n,get:w,listeners:m,context:t,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",c=e("gos"),f=e(2),s={},p={},d=t.exports=o();d.backlog=s},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!x++){var e=h.info=NREUM.info,t=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return s.abort();f(y,function(t,n){e[t]||(e[t]=n)}),c("mark",["onload",a()+h.offset],null,"api");var n=d.createElement("script");n.src="https://"+e.agent,t.parentNode.insertBefore(n,t)}}function o(){"complete"===d.readyState&&i()}function i(){c("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),c=e("handle"),f=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1071.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=t.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),c("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);
        ;NREUM.info={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",licenseKey:"61d58eabe5",applicationID:"102468771",sa:1}
    </script>        

    
<link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/vendor/titillium-web/styles.css">

    
<link rel="stylesheet" href="/vendor/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">


    
<script src="/vendor/jquery/2.0.3/jquery.min.js"></script>

    
    
        
<link rel="stylesheet" href="/vendor/fancybox/jquery.fancybox.css">

    
    
        
<link rel="stylesheet" href="/vendor/scrollLoading/style.css">

    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-58006445-2', 'auto');
ga('send', 'pageview');

</script>
    
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/homelab/index.html">Home Lab</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/about/index.html">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://blog.rylander.io"></form>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    Blog
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        How to Migrate From an Existing UBNT EdgeRouter to a USG
        </h1>
    

            </header>
        
        <div class="article-subtitle">
            <a href="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/" class="article-date">
    <time datetime="2017-06-29T19:12:47.000Z" itemprop="datePublished">2017-06-29</time>
</a>
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubnt/" rel="tag">ubnt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unifi/" rel="tag">unifi</a></li></ul>

        </div>
        <div class="article-entry" itemprop="articleBody">
            <p>So you’ve been secretly oogling the shiny USG device and the been frustrated with the Controller software and blank graphics like me? I can verify that the migration process is quite straight forward, with some manual lifting involved.</p>
<p>The process is like this:</p>
<ol>
<li>Dump you existing ERL configuration to a textfile, save it on your computer and never touch the ERL again.</li>
<li>Hook up your new USG to your computer via the LAN port. </li>
<li>Move your new configuration over to the new device, such as external WAN ip settings and local LAN settings, including DHCP static leases etc. You need to also delete any existing conflicting settings, or the new/changed settings won’t take.</li>
<li>commit, save, and reboot</li>
<li>specify the unifi controller adoption url if neccessary and discover and adopt the new device via the controller software</li>
</ol>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/89b8de5c-2eed-4682-bfce-5fd8fab45e14.jpg" class="">

<h2 id="Dump-existing-ERL-configuration-to-a-text-file"><a href="#Dump-existing-ERL-configuration-to-a-text-file" class="headerlink" title="Dump existing ERL configuration to a text file"></a>Dump existing ERL configuration to a text file</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin@erl:~$ show configuration commands &gt; config.txt</span><br></pre></td></tr></table></figure>


<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/dump-existing-erl-configuration-to-a-text-file.png" class="">

<p>The commands are ready to be copy &amp; pasted into your new device. As the device is preconfigured with some conflicting settings, it is not possible to run this as a script, as you must delete existing settings before committing.</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/93bdf8b7-dc62-4e10-9be1-2d35be01049a.png" class="">

<h2 id="Connect-new-device-to-local-computer"><a href="#Connect-new-device-to-local-computer" class="headerlink" title="Connect new device to local computer"></a>Connect new device to local computer</h2><p>Attach your local computer to the LAN port on the USG. The USG will serve out DHCP address in the 192.168.1.1/24 range and the router default adress is 192.168.1.1.</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/connect-new-device-to-local-computer.png" class="">

<h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>Login using default settings ubnt/ubnt</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/login.png" class="">

<h2 id="Script-settings"><a href="#Script-settings" class="headerlink" title="Script settings"></a>Script settings</h2><p>You could script settings (which I tried at first) but since existing configuration clashes with the new updated ones, you would first need to prep the script with delete commands. This would be usable if I had many devices but since I only have one, its easier to copy paste relevant lines directly.</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/script-settings.png" class="">

<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/80aa6023-6167-4441-b688-6f1769cbf20d.png" class="">

<p>chmod +x erl_config.sh</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/4f550f90-64c0-48fe-8a8b-66cc55d3c5fe.png" class="">

<p>When you execute, the script will fail to commit due to conflicting changes.</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/43937bd5-a6a2-4ae3-b2f0-3e1d5ebf2ccf.png" class="">

<p>Some settings will take though</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/28f16f7d-7d9f-465c-904c-7579fca503b4.png" class="">

<h2 id="Set-static-LAN-ip-address"><a href="#Set-static-LAN-ip-address" class="headerlink" title="Set static LAN ip address"></a>Set static LAN ip address</h2><p>The LAN port is given a static ip.</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">configure</span><br><span class="line">edit interfaces ethernet eth1</span><br><span class="line">set address 10.0.1.1/24</span><br><span class="line">delete address 192.168.1.1/24</span><br><span class="line">commit</span><br></pre></td></tr></table></figure>


<p>You will loose connectivity at this point. Do not reboot the device as the settings will not survive until you save.</p>
<p>Update your local computer IP settings to match your new LAN network.</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/set-static-lan-ip-address.png" class="">

<h3 id="Update-known-hosts"><a href="#Update-known-hosts" class="headerlink" title="Update known_hosts"></a>Update known_hosts</h3><p>If you like me replace an existing device, chances are you need to update the SSH configuration.</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano ~/.ssh/known_hosts</span><br></pre></td></tr></table></figure>


<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/update-known_hosts.png" class="">

<h2 id="Set-WAN-configuration"><a href="#Set-WAN-configuration" class="headerlink" title="Set WAN configuration"></a>Set WAN configuration</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">configure</span><br><span class="line">show interfaces</span><br><span class="line">set interfaces ethernet eth0 address *you wan ip/size*</span><br></pre></td></tr></table></figure>




<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/set-wan-configuration.png" class="">

<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show interfaces ethernet eth0</span><br></pre></td></tr></table></figure>


<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/6fd11612-4251-4920-8426-f931817f83b4.png" class="">

<p>show service dhcp-server</p>
<p>delete service dhcp-server</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/5b825ab9-6d73-4244-8dff-bf0a450547cb.png" class="">

<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">set service dhcp-server shared-network-name LAN1 authoritative disable</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 default-router 10.0.1.1</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 dns-server 10.0.1.9</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 dns-server 10.0.1.6</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 domain-name rylander.io</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 lease 86400</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 start 10.0.1.100 stop 10.0.1.199</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping Familjens-iPad ip-address 10.0.1.151</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping Familjens-iPad mac-address '2c:1f:23:23:d7:e6'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping FamiljensiPad2 ip-address 10.0.1.170</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping FamiljensiPad2 mac-address '74:e1:b6:b7:69:85'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping FamiljensiPhone ip-address 10.0.1.176</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping FamiljensiPhone mac-address 'c0:9f:42:a4:68:e8'</span><br><span class="line">...</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping VeraLite ip-address 10.0.1.104</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping VeraLite mac-address '00:0e:8f:df:f2:79'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping XboxOne ip-address 10.0.1.116</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping XboxOne mac-address 'c0:33:5e:d8:e1:79'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping kidsPad ip-address 10.0.1.122</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping kidsPad mac-address 'a8:88:08:be:9c:d5'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping photon-nginx-proxy ip-address 10.0.1.32</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping photon-nginx-proxy mac-address '00:50:56:94:21:8b'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping tinboy ip-address 10.0.1.124</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 static-mapping tinboy mac-address 'c8:2a:14:2d:f3:dd'</span><br><span class="line">set service dhcp-server shared-network-name LAN1 subnet 10.0.1.0/24 unifi-controller 10.0.1.21</span><br></pre></td></tr></table></figure>


<h2 id="Adopt-the-USG-to-the-controller"><a href="#Adopt-the-USG-to-the-controller" class="headerlink" title="Adopt the USG to the controller"></a>Adopt the USG to the controller</h2><p>Since my internal DNS isn’t used by the router, I need to map a hostname to an ip. The default mapping can be removed.</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edit system static-host-mapping</span><br></pre></td></tr></table></figure>


<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/adopt-the-usg-to-the-controller.png" class="">

<h3 id="Set-local-host-mapping"><a href="#Set-local-host-mapping" class="headerlink" title="Set local host mapping"></a>Set local host mapping</h3><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set host-name unifi.rylander.io inet 10.0.1.21</span><br></pre></td></tr></table></figure>


<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/set-local-host-mapping.png" class="">

<h3 id="Verify-connection-to-controller-and-initiate-adoption"><a href="#Verify-connection-to-controller-and-initiate-adoption" class="headerlink" title="Verify connection to controller and initiate adoption"></a>Verify connection to controller and initiate adoption</h3><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping unifi.rylander.io</span><br></pre></td></tr></table></figure>


<p>If the controller can’t find the USG device you can inform the controller by setting the inform url.</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unifi set-inform [http://unifi.rylander.io:18080/inform](http://unifi.rylander.io:18080/inform)</span><br></pre></td></tr></table></figure>


<p>As I had forgot to port forward the adoption port from my dockerized controller, this step was a bit frustrating at first. Note the screenshot is misleading as a result. I ended up forwarding the dockerized controller port 8080 to the Synology host port 18080 (and remembering why I didn’t forward port 8080 directly).</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/verify-connection-to-controller-and-initiate-adoption.png" class="">

<h3 id="Check-status"><a href="#Check-status" class="headerlink" title="Check status"></a>Check status</h3><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unifi info</span><br></pre></td></tr></table></figure>


<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/check-status.png" class="">

<h3 id="Pending-adoption"><a href="#Pending-adoption" class="headerlink" title="Pending adoption"></a>Pending adoption</h3><p>Remember to actually click the “Adopt” link in the controller UI.</p>
<p>Then you also need to go back to the SSH session and reissue the command to make it stick.</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/pending-adoption.png" class="">

<h3 id="Adopting"><a href="#Adopting" class="headerlink" title="Adopting"></a>Adopting</h3><img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/adopting.png" class="">

<h3 id="Provisioning"><a href="#Provisioning" class="headerlink" title="Provisioning"></a>Provisioning</h3><img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/provisioning.png" class="">

<h3 id="Verify-settings"><a href="#Verify-settings" class="headerlink" title="Verify settings"></a>Verify settings</h3><p>The controller will preserve existing settings</p>
<img src="/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/verify-settings.png" class="">
        </div>
        <footer class="article-footer">
            


    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share" target="_blank" rel="noopener">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>


        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="youtube" href="https://youtube.com" target="_blank">
                        <i class="icon fa fa-youtube"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/mry" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://www.linkedin.com" target="_blank">
                        <i class="icon fa fa-linkedin"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/07/04/resize-photon-root-disk/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">newer</strong>
        <p class="article-nav-title">
        
            Resize Photon Root Disk
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2017/06/16/setup-static-website-hosting-on-amazon-s3-bucket/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">older</strong>
        <p class="article-nav-title">Setup Static Website Hosting on Amazon S3 Bucket</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2020/04/28/add-lets-encrypt-certificate-to-vcenter-7/" class="thumbnail">
    
    
        <span style="background-image:url(/2020/04/28/add-lets-encrypt-certificate-to-vcenter-7/chainoftrust.png)" alt="Add Let&#39;s Encrypt Certificate to vCenter 7" class="thumbnail-image"></span>
    
    
</a>
                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2020/04/28/add-lets-encrypt-certificate-to-vcenter-7/" class="title">Add Let&#39;s Encrypt Certificate to vCenter 7</a></p>
                            <p class="item-date"><time datetime="2020-04-28T18:52:09.000Z" itemprop="datePublished">2020-04-28</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/03/setup-cloudflare-access/" class="thumbnail">
    
    
        <span style="background-image:url(/2018/08/03/setup-cloudflare-access/238b904a-3b2c-413c-aad4-85a62a7e72b3.png)" alt="Setup Cloudflare Access" class="thumbnail-image"></span>
    
    
</a>
                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/08/03/setup-cloudflare-access/" class="title">Setup Cloudflare Access</a></p>
                            <p class="item-date"><time datetime="2018-08-03T18:55:32.000Z" itemprop="datePublished">2018-08-03</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/08/03/using-github-pages-as-web-host-and-cloudflare-as-cdn/" class="thumbnail">
    
    
        <span style="background-image:url(/2018/08/03/using-github-pages-as-web-host-and-cloudflare-as-cdn/662949ef-1d9a-4b56-bc56-5e26c9936cf1.png)" alt="Using GitHub Pages as Web Host and Cloudflare as CDN" class="thumbnail-image"></span>
    
    
</a>
                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/08/03/using-github-pages-as-web-host-and-cloudflare-as-cdn/" class="title">Using GitHub Pages as Web Host and Cloudflare as CDN</a></p>
                            <p class="item-date"><time datetime="2018-08-03T18:15:14.000Z" itemprop="datePublished">2018-08-03</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/07/28/install-windows-admin-center-on-windows-server-2016-core/" class="thumbnail">
    
    
        <span style="background-image:url(/2018/07/28/install-windows-admin-center-on-windows-server-2016-core/76faea3f-0cac-4ad4-be02-62db289a26df.jpg)" alt="Install Windows Admin Center on Windows Server 2016 Core" class="thumbnail-image"></span>
    
    
</a>
                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/07/28/install-windows-admin-center-on-windows-server-2016-core/" class="title">Install Windows Admin Center on Windows Server 2016 Core</a></p>
                            <p class="item-date"><time datetime="2018-07-28T10:19:36.000Z" itemprop="datePublished">2018-07-28</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/07/21/local-https-dev-proxy-using-lets-encrypt-and-cloudflare/" class="thumbnail">
    
    
        <span style="background-image:url(/2018/07/21/local-https-dev-proxy-using-lets-encrypt-and-cloudflare/b8fd7d88-5173-425f-8a2b-d9e08c03e89d.png)" alt="Local HTTPS Dev Proxy Using Lets Encrypt and Cloudflare" class="thumbnail-image"></span>
    
    
</a>
                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/07/21/local-https-dev-proxy-using-lets-encrypt-and-cloudflare/" class="title">Local HTTPS Dev Proxy Using Lets Encrypt and Cloudflare</a></p>
                            <p class="item-date"><time datetime="2018-07-21T08:05:15.000Z" itemprop="datePublished">2018-07-21</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/aws/" style="font-size: 10px;">aws</a> <a href="/tags/azure/" style="font-size: 10px;">azure</a> <a href="/tags/backup/" style="font-size: 10px;">backup</a> <a href="/tags/blog/" style="font-size: 11.11px;">blog</a> <a href="/tags/cdn/" style="font-size: 13.33px;">cdn</a> <a href="/tags/cloudflare/" style="font-size: 15.56px;">cloudflare</a> <a href="/tags/crashplan/" style="font-size: 12.22px;">crashplan</a> <a href="/tags/dev/" style="font-size: 10px;">dev</a> <a href="/tags/digitalocean/" style="font-size: 11.11px;">digitalocean</a> <a href="/tags/dns/" style="font-size: 12.22px;">dns</a> <a href="/tags/docker/" style="font-size: 18.89px;">docker</a> <a href="/tags/docs/" style="font-size: 10px;">docs</a> <a href="/tags/edgerouter/" style="font-size: 11.11px;">edgerouter</a> <a href="/tags/esxi/" style="font-size: 16.67px;">esxi</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 12.22px;">github</a> <a href="/tags/hexo/" style="font-size: 15.56px;">hexo</a> <a href="/tags/howto/" style="font-size: 20px;">howto</a> <a href="/tags/letsencrypt/" style="font-size: 12.22px;">letsencrypt</a> <a href="/tags/nas/" style="font-size: 11.11px;">nas</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nvm/" style="font-size: 10px;">nvm</a> <a href="/tags/oauth/" style="font-size: 10px;">oauth</a> <a href="/tags/osx/" style="font-size: 13.33px;">osx</a> <a href="/tags/photon/" style="font-size: 14.44px;">photon</a> <a href="/tags/plex/" style="font-size: 12.22px;">plex</a> <a href="/tags/rpi/" style="font-size: 10px;">rpi</a> <a href="/tags/s3/" style="font-size: 10px;">s3</a> <a href="/tags/splunk/" style="font-size: 10px;">splunk</a> <a href="/tags/ssh/" style="font-size: 11.11px;">ssh</a> <a href="/tags/ssl/" style="font-size: 14.44px;">ssl</a> <a href="/tags/synology/" style="font-size: 17.78px;">synology</a> <a href="/tags/sysop/" style="font-size: 10px;">sysop</a> <a href="/tags/ubnt/" style="font-size: 15.56px;">ubnt</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/unifi/" style="font-size: 14.44px;">unifi</a> <a href="/tags/usg/" style="font-size: 10px;">usg</a> <a href="/tags/vmware/" style="font-size: 18.89px;">vmware</a> <a href="/tags/vpn/" style="font-size: 11.11px;">vpn</a> <a href="/tags/vsan/" style="font-size: 11.11px;">vsan</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/tags/web/" style="font-size: 11.11px;">web</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/windows-core/" style="font-size: 10px;">windows_core</a> <a href="/tags/zsh/" style="font-size: 11.11px;">zsh</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a>
                    </li>
                
                    <li>
                        <a href="https://github.com/ppoffice/hexo-theme-hueman" target="_blank" rel="noopener">Hueman theme</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2020 emryl</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'emryl';
    
    
    var disqus_url = 'https://blog.rylander.io/2017/06/29/how-to-migrate-from-an-existing-ubnt-edgerouter-to-a-usg/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>



    
        
<script src="/vendor/fancybox/jquery.fancybox.pack.js"></script>

    

    
        
<script src="/vendor/scrollLoading/jquery.scrollLoading.js"></script>

        
<script src="/vendor/scrollLoading/main.js"></script>

    


<!-- Custom Scripts -->

<script src="/js/main.js"></script>


    </div>
</body>
</html>
